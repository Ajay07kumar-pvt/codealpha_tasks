#  SALES PREDICTION USING PYTHON
# CodeAlpha Data Science Internship - Task 4

# Step 1: Import required libraries
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_absolute_error, mean_squared_error, r2_score

# Step 2: Load dataset
#  Replace 'sales.csv' with your actual dataset file name
df = pd.read_csv("sales.csv")

# Step 3: Explore the dataset
print(" First 5 rows of dataset:")
print(df.head())

print("\n Dataset Information:")
print(df.info())

print("\n Statistical Summary:")
print(df.describe())

# Step 4: Check for missing values
print("\n Missing Values:")
print(df.isnull().sum())

# Step 5: Clean column names for easier handling
df.columns = [col.strip().replace(" ", "_").lower() for col in df.columns]
print("\n Cleaned Column Names:", df.columns.tolist())

# Step 6: Visualize relationships
plt.figure(figsize=(6,5))
sns.heatmap(df.corr(numeric_only=True), annot=True, cmap='coolwarm')
plt.title("Correlation Heatmap")
plt.show()

# Example assumption: dataset has columns like ['TV', 'Radio', 'Newspaper', 'Sales']
# Modify these as per your dataset structure

# Step 7: Define features (X) and target (y)
if 'sales' in df.columns:
    X = df.drop('sales', axis=1)
    y = df['sales']
else:
    print(" Please rename your target column as 'sales' before running.")

# Step 8: Split data into train and test sets
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# Step 9: Train Linear Regression Model
model = LinearRegression()
model.fit(X_train, y_train)

# Step 10: Make Predictions
y_pred = model.predict(X_test)

# Step 11: Evaluate Model
mae = mean_absolute_error(y_test, y_pred)
mse = mean_squared_error(y_test, y_pred)
rmse = np.sqrt(mse)
r2 = r2_score(y_test, y_pred)

print("\n Model Evaluation Results:")
print("Mean Absolute Error (MAE):", round(mae, 2))
print("Mean Squared Error (MSE):", round(mse, 2))
print("Root Mean Squared Error (RMSE):", round(rmse, 2))
print("RÂ² Score:", round(r2, 3))

# Step 12: Visualize Predictions
plt.figure(figsize=(8,6))
plt.scatter(y_test, y_pred, color='blue')
plt.xlabel("Actual Sales")
plt.ylabel("Predicted Sales")
plt.title("Actual vs Predicted Sales")
plt.plot([y_test.min(), y_test.max()], [y_test.min(), y_test.max()], 'r--')
plt.show()

# Step 13: Feature Importance (Coefficients)
coeff_df = pd.DataFrame(model.coef_, X.columns, columns=['Coefficient'])
print("\n Feature Importance:\n", coeff_df)

plt.figure(figsize=(6,4))
sns.barplot(x=coeff_df['Coefficient'], y=coeff_df.index, palette="cool")
plt.title("Feature Importance (Model Coefficients)")
plt.show()

# Step 14: Make a Sample Prediction
sample = X_test.iloc[0:1]
predicted_sales = model.predict(sample)
print(f"\n Sample Prediction:")
print(f"Input Features:\n{sample}")
print(f"Predicted Sales Value: {predicted_sales[0]:.2f}")
